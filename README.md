# ğŸš€ GitHub Actions & Aliyun Container Registry (ACR) è‡ªåŠ¨åŒ–éƒ¨ç½²æ¨¡æ¿

æ“ä½œæ–‡æ¡£: [doc](https://hsky.xyz/docker-sync-github-acr-cn)

è¿™æ˜¯ä¸€ä¸ªæä¾› GitHub Actions å·¥ä½œæµæ¨¡æ¿çš„ä»“åº“ï¼Œæ—¨åœ¨å¸®åŠ©ä½ è‡ªåŠ¨åŒ–æ„å»º Docker é•œåƒå¹¶å°†å…¶å®‰å…¨åœ°æ¨é€åˆ° Aliyun Container Registry (ACR)ã€‚**åœ¨ä½¿ç”¨å‰ï¼Œè¯·åŠ¡å¿…å…ˆ Fork æœ¬ä»“åº“ï¼**

## âœ¨ é¡¹ç›®ç®€ä»‹

æœ¬ä»“åº“ä½œä¸ºä¸€ä¸ªæ¨¡æ¿ï¼Œæä¾›äº†ä¸€ä¸ªé¢„é…ç½®çš„ GitHub Actions å·¥ä½œæµã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•å®‰å…¨åœ°ç®¡ç†æ•æ„Ÿçš„ ACR è®¤è¯ä¿¡æ¯ï¼Œå¹¶åœ¨æ¯æ¬¡ä»£ç æ›´æ–°æ—¶è‡ªåŠ¨æ„å»ºå’Œæ¨é€ Docker é•œåƒã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**

*   **å®‰å…¨è®¤è¯**: é€šè¿‡ GitHub Secrets å­˜å‚¨ä½ çš„ Aliyun ACR ç™»å½•å‡­æ®ï¼Œç¡®ä¿æ•æ„Ÿä¿¡æ¯ä¸è¢«æ³„éœ²ã€‚
*   **è‡ªåŠ¨åŒ–æ„å»º**: æ¯æ¬¡ä»£ç æäº¤éƒ½ä¼šè§¦å‘ Docker é•œåƒçš„è‡ªåŠ¨æ„å»ºã€‚
*   **æ— ç¼é›†æˆ**: ç›´æ¥å°†æ„å»ºå¥½çš„ Docker é•œåƒæ¨é€åˆ°ä½ æŒ‡å®šçš„ Aliyun ACR ä»“åº“ã€‚

## ğŸ“‹ å…ˆå†³æ¡ä»¶

åœ¨å¼€å§‹ä½¿ç”¨æœ¬æ¨¡æ¿ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²æ‹¥æœ‰ä»¥ä¸‹æ¡ä»¶ï¼š

*   ä¸€ä¸ª GitHub è´¦å·ã€‚
*   ä¸€ä¸ªé˜¿é‡Œäº‘è´¦å·ï¼Œå¹¶å·²å¼€é€š [å®¹å™¨é•œåƒæœåŠ¡ (Container Registry, ACR)](https://cr.console.aliyun.com/cn-hangzhou/instances)ã€‚
*   åœ¨ ACR ä¸­å·²åˆ›å»ºè‡³å°‘ä¸€ä¸ª**å‘½åç©ºé—´**ã€‚
*   æ‹¥æœ‰æ¨é€åˆ°è¯¥ ACR ä»“åº“çš„æƒé™ï¼ˆé€šå¸¸æ˜¯å­è´¦å·çš„ AccessKey æˆ–ä¸º ACR è®¾ç½®çš„å›ºå®šå¯†ç ï¼‰ã€‚

## ğŸ”‘ é…ç½® GitHub Secrets (æ ¸å¿ƒæ­¥éª¤)

**åœ¨ä½¿ç”¨æœ¬æ¨¡æ¿å‰ï¼Œä½ å¿…é¡»å…ˆ Fork æœ¬ä»“åº“ï¼Œç„¶ååœ¨ä½  Fork åçš„ä¸ªäººä»“åº“ä¸­è®¾ç½®ä»¥ä¸‹ GitHub Secretsã€‚**

GitHub Secrets å…è®¸ä½ å®‰å…¨åœ°å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ API å¯†é’¥æˆ–å¯†ç ã€‚å®ƒä»¬åœ¨å·¥ä½œæµè¿è¡Œæ—¥å¿—ä¸­æ°¸è¿œä¸ä¼šè¢«æš´éœ²ã€‚

### è®¾ç½®æ­¥éª¤

1.  **ç¬¬ä¸€æ­¥ï¼šFork æœ¬ä»“åº“**
    ç‚¹å‡»æœ¬é¡µå³ä¸Šè§’çš„ "**Fork**" æŒ‰é’®ï¼Œå°†æœ¬ä»“åº“å¤åˆ¶åˆ°ä½ è‡ªå·±çš„ GitHub è´¦å·ä¸‹ã€‚

2.  **ç¬¬äºŒæ­¥ï¼šè¿›å…¥ä½  Fork åçš„ä»“åº“è®¾ç½®**
    å¯¼èˆªåˆ° **ä½  Fork åçš„ä»“åº“é¡µé¢** (ä¾‹å¦‚ï¼š`github.com/ä½ çš„ç”¨æˆ·å/æœ¬ä»“åº“å`)ã€‚
    ç‚¹å‡»é¡¶éƒ¨çš„ "**Settings**" (è®¾ç½®)ã€‚

3.  **ç¬¬ä¸‰æ­¥ï¼šè¿›å…¥ Secrets å’Œ Variables é…ç½®é¡µé¢**
    åœ¨å·¦ä¾§å¯¼èˆªæ ä¸­ï¼Œæ‰¾åˆ°å¹¶ç‚¹å‡» "**Secrets and variables**"ã€‚
    ç‚¹å‡»å…¶ä¸‹çš„å­èœå• "**Actions**"ã€‚

4.  **ç¬¬å››æ­¥ï¼šæ·»åŠ  Repository Secrets**

    ç‚¹å‡»å³ä¸Šè§’çš„ "**New repository secret**" (æ–°å»ºä»“åº“ç§˜é’¥)ã€‚

    ä½ éœ€è¦æ·»åŠ ä»¥ä¸‹å››ä¸ª Secretsã€‚è¯·æ ¹æ®ä½ åœ¨ Aliyun ACR ä¸­çš„å®é™…ä¿¡æ¯è¿›è¡Œå¡«å†™ï¼š

    *   **`ACR_USERNAME`**
        *   **æè¿°**: Aliyun ACR çš„ç™»å½•ç”¨æˆ·åã€‚é€šå¸¸æ˜¯ä½ çš„é˜¿é‡Œäº‘ä¸»è´¦å·åæˆ–æ‹¥æœ‰ ACR æ“ä½œæƒé™çš„å­è´¦å·åã€‚
        *   **å€¼**: ä½ çš„ Aliyun ACR ç”¨æˆ·åï¼Œä¾‹å¦‚ `your_aliyun_account_name`ã€‚

    *   **`ACR_PASSWORD`**
        *   **æè¿°**: Aliyun ACR çš„ç™»å½•å¯†ç ã€‚è¿™é€šå¸¸æ˜¯ä½ ä¸º ACR è®¾ç½®çš„å›ºå®šå¯†ç ï¼Œè€Œä¸æ˜¯ä½ çš„é˜¿é‡Œäº‘ç™»å½•å¯†ç ã€‚ä½ å¯ä»¥åœ¨ ACR æ§åˆ¶å°çš„ "è®¿é—®å‡­è¯" æˆ– "å®ä¾‹æ¦‚è§ˆ" ä¸­æ‰¾åˆ°å¹¶è®¾ç½®ã€‚
        *   **å€¼**: ä½ çš„ Aliyun ACR å¯†ç ã€‚

    *   **`ACR_REGISTRY`**
        *   **æè¿°**: Aliyun ACR çš„æ³¨å†Œè¡¨åœ°å€ã€‚è¿™å–å†³äºä½ çš„åœ°åŸŸã€‚ä¾‹å¦‚ï¼š
            *   åä¸œ1/æ­å·: `registry.cn-hangzhou.aliyuncs.com`
            *   åä¸œ2/ä¸Šæµ·: `registry.cn-shanghai.aliyuncs.com`
            *   åå—1/æ·±åœ³: `registry.cn-shenzhen.aliyuncs.com`
            *   ...æ›´å¤šè¯·å‚è€ƒé˜¿é‡Œäº‘å®˜æ–¹æ–‡æ¡£ã€‚
        *   **å€¼**: ä½ çš„ Aliyun ACR Registry URLï¼Œä¾‹å¦‚ `registry.cn-hangzhou.aliyuncs.com`ã€‚

    *   **`ACR_NAMESPACE`**
        *   **æè¿°**: ä½ åœ¨ Aliyun ACR ä¸­åˆ›å»ºçš„å‘½åç©ºé—´åç§°ã€‚æ‰€æœ‰æ¨é€åˆ° ACR çš„é•œåƒéƒ½ä¼šå½’å±åˆ°æŸä¸ªå‘½åç©ºé—´ä¸‹ã€‚
        *   **å€¼**: ä½ çš„ Aliyun ACR å‘½åç©ºé—´åç§°ï¼Œä¾‹å¦‚ `my-project-namespace`ã€‚

### å…³äº GitHub Variables (å¯é€‰)

è™½ç„¶æœ¬å·¥ä½œæµçš„æ ¸å¿ƒæ˜¯ Secretsï¼Œä½†ä½ ä¹Ÿå¯ä»¥åœ¨ "Secrets and variables" -> "Actions" é¡µé¢ä¸‹ç‚¹å‡» "**Variables**" æ ‡ç­¾é¡µï¼Œå¹¶ç‚¹å‡» "**New repository variable**" æ¥æ·»åŠ éæ•æ„Ÿé…ç½®ä¿¡æ¯ã€‚

